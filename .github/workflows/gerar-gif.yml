name: Gerar GIF das Barras

on:
  workflow_dispatch:
  push:
    branches: [main]
    paths:
      - 'input/**.json'
      - 'gerar-gif.js'

jobs:
  gerar-gif:
    runs-on: ubuntu-latest

    permissions:
      contents: write

    steps:
      - name: ğŸ“¥ Clonar repositÃ³rio
        uses: actions/checkout@v3

      - name: ğŸŸ¨ Instalar Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: ğŸ“¦ Instalar Puppeteer e dependÃªncias
        run: |
          npm install puppeteer

      - name: ğŸ“¸ Gerar imagens com Puppeteer
        run: node gerar-gif.js

      - name: âœ… Commitar imagens
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add output/*.png
          git commit -m "ğŸ“¸ Gerar PNGs com animaÃ§Ã£o" || echo "Nada novo"
          git pull --rebase
          git push
